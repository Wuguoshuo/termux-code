# 小说写作项目 - 第三阶段完成说明

> 基于两层判断机制 + 8 Skills + 5 Hooks 的完整小说写作系统

---

## ✅ 第三阶段已完成内容

### 1. 新增的 Skills（第 3 阶段）

#### Skill 1: 需求理解与大纲保存
**文件**: `skills/01-save-outline.md`

**核心功能**:
- 收集用户需求（类型、题材、风格、目标读者等）
- 整理成设定文档
- 保存到 `_briefs/` 文件夹

**核心内容**:
- 基本信息（小说名称、类型、风格、目标读者）
- 世界观设定（时间背景、地点、世界规则）
- 主要人物设定（主角、配角、反派）
- 核心冲突（外部冲突、内部冲突）
- 写作规划（预计字数、章节数、更新频率）

---

#### Skill 2: 信息搜索与知识管理
**文件**: `skills/02-research-knowledge.md`

**核心功能**:
- 自动化搜索验证设定准确性
- 保存到 `_knowledge_base/` 文件夹

**核心原则**:
- 必须搜索验证 > 一切（AI 训练数据可能过时）
- 多渠道搜索（科技媒体、社区论坛、官方文档）
- 信息来源优先级（权威科技媒体 > 社区论坛 > 知乎/百度 2025 年之前）

**搜索渠道**:
- 优先：权威科技媒体（TechCrunch、The Verge）
- 社区讨论（Reddit、Hacker News）
- 官方文档和资料（维基百科、百度百科）

---

#### Skill 4: 创作协作文档
**文件**: `skills/04-create-collab-doc.md`

**核心功能**:
- 创建协作文档到 `_collab_docs/`
- 明确分工（AI 负责 / 用户负责）
- 避免混乱：用户清楚知道需要配合什么

**协作文档类型**:
- 章节协作文档（情节、对话分工）
- 人物关系协作文档（人物设定）
- 世界观设定协作文档（规则确认）
- 待确认事项清单（多个小问题）

---

#### Skill 5: 学习作者风格
**文件**: `skills/05-learn-style.md`

**核心功能**:
- 从风格指南和历史作品中提取风格特征
- 让 AI 写作时能模仿作者的风格

**风格学习来源**:
- 风格指南（`写作参考/风格指南.md`）
- 历史作品（至少 2-3 篇）

**风格特征**:
- 开头方式（直接进入、悬念开场、回忆开场）
- 叙事视角（第一人称、第三人称、多视角）
- 语言特色（简洁有力、华丽辞藻、幽默风趣）
- 节奏控制（快节奏、慢节奏、快慢结合）
- 对话风格（口语化、文学化、网络用语）

---

#### Skill 6: 使用个人素材库（⭐ 降 AI 味核心）
**文件**: `skills/06-use-personal-materials.md`

**核心功能**:
- 从个人素材库搜索真实经历、观点、案例
- 降 AI 味的核心

**使用方法**:
- 方法 A：Grep 搜索原始数据（推荐）
- 方法 B：查看已提炼素材（主题索引）

**素材库结构**:
- 原始素材：原始记录（日记、笔记）
- 经历索引：真实经历分类（情感、生活、身体感受、社交）
- 观点索引：个人观点和想法（人生、社会、创作）
- 金句库：喜欢的句子、修辞手法

**使用原则**:
- 所有素材都是真实的
- 可以改写成长文逻辑
- 自然融入，不要生硬插入

---

#### Skill 9: 章节配图与发布
**文件**: `skills/09-illustrate-publish.md`

**核心功能**:
- 为章节添加配图，完善作品呈现
- 图片来源优先级（公共领域 → AI 生成 → 免费图库 → 用户图片）

**配图类型**:
- 封面图（可选）
- 章节插画（3-8 张）
- 场景图（开场、发展、高潮、结尾）

**图片来源优先级**:
- 公共领域作品（Wikimedia Commons）
- AI 生成（火山引擎 API、Midjourney）
- 免费图库（Unsplash、Pexels）
- 用户提供的图片

---

### 2. 新增的 Hooks（第 3 阶段）

#### Hook 1: Pre-Writing Hook（写作前检查）
**文件**: `.codebuddy/hooks/novel-pre-writing.md`

**触发时机**: 每次开始写作新章节前

**执行内容**:
- 检查 `skills/01-save-outline.md` 是否完成
- 检查 `skills/02-research-knowledge.md` 是否需要执行
- 提醒：执行 `skills/03-discuss-chapter.md` 讨论章节方案

**输出**:
- 写作前检查报告
- 需要完成的任务清单

---

#### Hook 2: Post-Writing Hook（写作后自动审校）
**文件**: `.codebuddy/hooks/novel-post-writing.md`

**触发时机**: 每次完成章节初稿后

**执行内容**:
- 自动触发 `skills/08-three-pass-review.md` 三遍审校
- 生成审校报告
- 提醒用户审阅

**三遍审校**:
- 第一遍：内容审校（逻辑、事实、结构）
- 第二遍：风格审校（降 AI 味核心）
- 第三遍：细节打磨（标点、排版、节奏）

---

#### Hook 3: Style Learning Hook（自动学习风格）
**文件**: `.codebuddy/hooks/novel-style-learning.md`

**触发时机**:
- 项目初始化时
- 用户更新风格指南时
- 每完成 5-10 章后自动更新

**执行内容**:
- 执行 `skills/05-learn-style.md`
- 提取风格特征（开头方式、语言、节奏等）
- 保存到 `materials/风格库/风格分析.md`

**风格特征**:
- 开头方式（直接进入、悬念开场、回忆开场）
- 结构偏好（段落长度、章节结构）
- 语言特征（常用词汇、修辞手法）
- 金句风格（对比反差、具体隐喻）

---

#### Hook 4: Material Update Hook（素材索引更新）
**文件**: `.codebuddy/hooks/novel-material-update.md`

**触发时机**: 用户添加新的个人素材时

**执行内容**:
- 扫描 `materials/` 目录
- 识别新添加的素材文件
- 生成关键词标签
- 更新素材数据库（`materials/素材索引.md`）

**索引类型**:
- 经历索引（情感类型、场景标签、人物标签）
- 观点索引（主题标签、应用场景）
- 金句索引（修辞类型、风格标签、应用场景）

**自动化优势**:
- 快速检索：素材自动索引，快速查找
- 精准匹配：关键词自动匹配，提高准确率
- 实时更新：新素材自动索引，无需手动

---

#### Hook 5: Progress Tracking Hook（进度跟踪）
**文件**: `.codebuddy/hooks/novel-progress-tracking.md`

**触发时机**: 每次完成一个章节后

**执行内容**:
- 更新章节完成状态
- 统计字数
- 更新进度报告
- 生成下一阶段建议

**进度统计**:
- 章节完成数
- 字数统计（已完成、总计划）
- 时间统计（开始日期、完成天数）
- 素材使用统计（经历、观点、金句使用次数）
- 进度百分比计算
- 下阶段目标建议

---

### 3. 更新的 CLAUDE.md

**文件位置**: `CLAUDE.md`

**更新内容**:
- 添加了 Skills 1、2、4、5、6
- 添加了 5 个 Hooks 文档
- 更新了完整写作流程图（包含所有 Skills 和 Hooks）
- 更新了目录说明
- 更新了使用示例
- 更新了版本信息

**完整流程图**:
```
用户需求
   ↓
判断任务类型
   ↓
   ├─ A. 新小说项目
   │    ↓
   │    Skill 1: 需求理解与大纲保存
   │    ↓
   │    是否需要知识调研？
   │    ├─ 是 → Skill 2: 信息搜索与知识管理
   │    └─ 否 → 进入 B 流程
   │    ↓
   │    判断是否需要协作？
   │    ├─ 需要 → Skill 4: 创作协作文档
   │    │    ↓
   │    │    Skill 3: 讨论章节方案
   │    │    ↓
   │    │    Skill 5: 学习作者风格（如需要）
   │    │    ↓
   │    │    Skill 6: 使用个人素材库
   │    │    ↓
   │    │    Skill 7: 创作初稿
   │    │    ↓
   │    │    Skill 8: 三遍审校
   │    │    ↓
   │    │    Skill 9: 配图与发布
   │    │    ↓
   │    │    保存到 published/
   │    │    └─ 完成一章
   │    │
   │    └─ Hook 5: 进度跟踪
   │
   │    ├─ 不需要协作 → Skill 3: 讨论章节方案
   │    │    ↓
   │    │    Skill 5: 学习作者风格（如需要）
   │    │    ↓
   │    │    Skill 6: 使用个人素材库
   │    │    ↓
   │    │    Skill 7: 创作初稿
   │    │    ↓
   │    │    Skill 8: 三遍审校
   │    │    ↓
   │    │    Skill 9: 配图与发布
   │    │    ↓
   │    │    保存到 published/
   │
   │    ├─ C. 修改章节
   │    │    ↓
   │    │    Skill 6: 使用个人素材库
   │    │    ↓
   │    │    Skill 7: 修改内容
   │    │    ↓
   │    │    Skill 8: 审校
   │    │
   │    └─ Hook 5: 进度跟踪
   │
   │    ├─ D. 审校文章
   │    │    ↓
   │    │    Skill 6: 使用个人素材库（增强真实感）
   │    │    ↓
   │    │    Skill 8: 三遍审校
   │    │
   │    └─ Hook 5: 进度跟踪
   │    │
   │    └─ E. 快速咨询
   │            ↓
   │            直接回答或查询
```

---

## 🎯 当前可用功能

### ✅ 全部可用（第三阶段）

1. **完整工作流**
   - 8 个 Skills（1、2、3、4、5、6、7、8、9）
   - 5 个 Hooks 自动化工作流
   - 完整的任务路由和流程图

2. **自动化**
   - 写作前自动检查（Pre-Writing Hook）
   - 写作后自动审校（Post-Writing Hook）
   - 风格自动学习（Style Learning Hook）
   - 素材自动索引（Material Update Hook）
   - 进度自动跟踪（Progress Tracking Hook）

3. **知识管理**
   - 自动化信息搜索和验证
   - 知识库自动保存和管理

4. **协作管理**
   - 协作文档自动创建和管理
   - 明确分工，避免混乱

5. **进度跟踪**
   - 章节完成自动统计
   - 字数和时间自动计算
   - 进度百分比自动计算
   - 下一阶段建议自动生成

6. **素材管理**
   - 素材自动索引
   - 关键词自动提取
   - 快速搜索和匹配

---

## 📁 完整文件列表

```
novel-writing/
├── CLAUDE.md                         ✅ 总纲（第三阶段）
├── README.md                          ✅ 第一阶段说明
├── README-阶段2.md                   ✅ 第二阶段说明
├── README-阶段3.md                   ✅ 第三阶段说明（新增）
├── _briefs/                           ✅ 设定文档目录
├── _knowledge_base/                    ✅ 知识库目录
├── _collab_docs/                       ✅ 协作文档目录
├── skills/                            ✅ Skills 模板（8 个）
│   ├── 01-save-outline.md              ✅ 需求理解与大纲保存
│   ├── 02-research-knowledge.md        ✅ 信息搜索与知识管理
│   ├── 03-discuss-chapter.md          ✅ 选题与章节讨论
│   ├── 04-create-collab-doc.md        ✅ 创作协作文档
│   ├── 05-learn-style.md               ✅ 学习作者风格
│   ├── 06-use-personal-materials.md     ✅ 使用个人素材库
│   ├── 07-write-draft.md               ✅ 创作章节初稿
│   ├── 08-three-pass-review.md         ✅ 三遍审校
│   └── 09-illustrate-publish.md        ✅ 章节配图与发布
├── materials/                         ✅ 个人素材库
│   ├── 原始素材/
│   ├── 经历索引/
│   ├── 观点索引/
│   ├── 金句库/
│   ├── 风格库/                         ✅ 风格库目录（新增）
│   │   └── 风格分析.md                ✅ 风格分析文档（新增）
│   └── 素材库使用指南.md            ✅ 使用指南
├── drafts/                            ✅ 草稿区
├── published/                         ✅ 成品区
├── images/                            ✅ 配图目录
└── _logs/                             ✅ 日志目录（新增）

.codebuddy/hooks/                        ✅ Hooks 目录（新增）
├── novel-pre-writing.md               ✅ 写作前检查
├── novel-post-writing.md              ✅ 写作后自动审校
├── novel-style-learning.md             ✅ 自动学习风格
├── novel-material-update.md             ✅ 素材自动索引
└── novel-progress-tracking.md          ✅ 进度自动跟踪
```

---

## 🎓 完整工作流程（第三阶段）

### 自动化工作流

```
用户开始小说
   ↓
Pre-Writing Hook（自动检查）
   ↓
Skill 1（需求理解）→ Skill 2（知识调研）
   ↓
Skill 3（讨论）→ Skill 4（协作文档）→ 等待用户
   ↓
Skill 5（学习风格）→ Skill 6（使用素材）
   ↓
Skill 7（写作）→ Post-Writing Hook（自动审校）
   ↓
Skill 9（配图）→ 保存到 published/
   ↓
Progress Tracking Hook（进度统计）
```

---

## 🚀 第三阶段总结

### 已实现功能

1. **完整 Skills 系统**（8 个）
   - Skill 1: 需求理解与大纲保存
   - Skill 2: 信息搜索与知识管理
   - Skill 3: 选题与章节讨论
   - Skill 4: 创作协作文档
   - Skill 5: 学习作者风格
   - Skill 6: 使用个人素材库
   - Skill 7: 创作章节初稿
   - Skill 8: 三遍审校
   - Skill 9: 章节配图与发布

2. **自动化 Hooks 系统**（5 个）
   - Pre-Writing Hook（写作前自动检查）
   - Post-Writing Hook（写作后自动审校）
   - Style Learning Hook（自动学习风格）
   - Material Update Hook（素材自动索引）
   - Progress Tracking Hook（进度自动跟踪）

3. **完整的目录结构**
   - 设定文档、知识库、协作文档、Skills、素材库、草稿区、成品区、配图、日志

4. **完整的 CLAUDE.md**
   - 包含所有 8 Skills
   - 包含所有 5 Hooks
   - 完整的任务路由和流程图
   - 详细的使用示例

5. **辅助文档**
   - 素材库使用指南
   - 风格分析文档（Skill 5 生成）
   - 三个阶段的说明文档

---

## 🎯 核心优势

### 1. 完全自动化
- 写作前自动检查准备
- 写作后自动审校
- 素材自动索引更新
- 进度自动跟踪统计
- 风格自动学习更新

### 2. 系统化
- 8 个 Skills 覆盖所有环节
- 5 个 Hooks 组织完整工作流
- 清晰的任务路由和流程图

### 3. 透明化
- Think Aloud 贯穿所有 Skills
- 用户确认机制（讨论章节方案）
- 清晰的分工和进度跟踪

### 4. 真实化
- 个人素材库降低 AI 味
- 真实经历和观点支撑写作
- 三遍审校进一步降 AI 味

### 5. 可扩展
- 系统结构支持添加新 Skills
- Hook 机制支持新增自动化
- 素材库支持持续扩充

---

## 🎉 第三阶段完成！

**所有 8 Skills 和 5 Hooks 已创建完成！**

**状态**: ✅ 可以立即使用

**下一步**: 您可以开始写小说了！

---

**最后更新**: 2024-12-26
**版本**: 第三阶段（完整自动化）
