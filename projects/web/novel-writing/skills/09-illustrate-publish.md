# Skill 9: 章节配图与发布

> 为章节添加配图，完善作品呈现
>
> 图片来源优先级：公共领域 → AI 生成 → 免费图库 → 用户图片

---

## 触发时机

1. 用户明确要求配图时
2. 自动触发（如章节发布到 published/ 时自动提示）
3. 用户要求添加封面时

---

## 工作流程

### Step 1: 分析章节配图需求

**Think Aloud 示例**:
```
用户要求为第3章配图...

我思考：
- 需要分析第3章的内容
- 确定需要什么类型的图片
- 推荐配图数量和类型

我的计划：
1. 读取第3章内容
2. 分析配图需求
3. 生成配图建议
4. 等待用户确认
5. 创建图片文件夹
6. 获取/生成图片
7. 插入到章节文档
```

**配图类型判断**:

#### 1. 封面图（可选）
- 小说整体封面
- 简洁大气，突出主题
- 建议尺寸：800x600 或 1200x800

#### 2. 章节插画（可选）
- 关键场景插画
- 人物形象图
- 氛围意境图

#### 3. 情节配图（可选）
- 开场场景图
- 高潮冲突图
- 结尾意境图

**推荐数量**:
- 单章节：3-8 张
- 封面：1 张
- 插画：2-3 张
- 场景图：3-5 张

---

### Step 2: 生成配图建议

**输出格式**:
```markdown
## 第 3 章配图建议

### 推荐配图类型

1. **封面图**（可选）
   - 风格：[描述风格]
   - 关键元素：[主要元素]
   - 建议尺寸：1200x800

2. **章节插画 1**
   - 场景：[哪个场景的插画]
   - 风格：[描述风格]
   - 关键元素：[主要元素]

3. **章节插画 2**
   [同上]

4. **场景图 1**
   - 场景：[哪个场景]
   - 描述：[画面描述]

5. **场景图 2**
   [同上]

### 图片来源优先级

1. 公共领域作品（Wikimedia Commons）
2. AI 生成（火山引擎 API、Midjourney）
3. 免费图库（Unsplash、Pexels）
4. 用户提供的图片
5. 官方素材（需注明来源）

### 推荐数量
- 总计：5-8 张
- 封面：1 张（可选）
- 插画：2-3 张
- 场景图：3-5 张

### 预计时间
- 搜索图片：10-20 分钟
- AI 生成：5-10 分钟/张
- 插入文档：5 分钟

---

**是否按照建议配图？**
- [ ] 是，按照上述建议
- [ ] 否，自行指定
- [ ] 部分采纳（说明）
```

---

### Step 3: 等待用户确认

**确认要点**:
- [ ] 配图类型确认？
- [ ] 配图数量确认？
- [ ] 图片来源确认？

**选项**:
- **选项 A**: 全部使用 AI 生成
- **选项 B**: 全部使用免费图库
- **选项 C**: 混合来源（部分 AI、部分图库）
- **选项 D**: 用户自行提供

---

### Step 4: 创建图片文件夹

**文件路径**: `images/小说名/`

**创建命令**:
```bash
mkdir -p projects/web/novel-writing/images/[小说名]
```

**命名规范**:
- 封面：`cover.jpg`
- 插画：`chapter-[章节号]-插画-[序号].jpg`
- 场景图：`chapter-[章节号]-场景-[序号].jpg`

---

### Step 5: 获取/生成图片

#### 来源 1: 公共领域作品（Wikimedia Commons）

**方法**:
- 搜索 Wikimedia Commons
- 选择符合场景的图片
- 确认许可类型（公共领域 / CC0 / CC BY）

**优点**:
- ✅ 免费使用
- ✅ 不需要注明作者（部分许可）
- ✅ 高质量

**缺点**:
- ❌ 需要搜索时间
- ❌ 不完全符合章节场景

---

#### 来源 2: AI 生成（推荐）

**方法**:
- 使用 AI 图像生成 API
- 根据场景描述生成图片
- 多次尝试优化

**推荐工具**:
- 火山引擎 API
- Midjourney
- Stable Diffusion（本地）

**优点**:
- ✅ 完全符合章节场景
- ✅ 快速生成
- ✅ 风格一致

**缺点**:
- ❌ 需要付费或 Token
- ❌ 质量不稳定

**使用示例**:
```
生成提示词（Prompt）：
"A Chinese novel scene, young protagonist in a laboratory,
discovering time machine, mysterious atmosphere,
dramatic lighting, cinematic style,
8K resolution, high quality"

生成参数：
- 尺寸：1200x800
- 风格：写实/动漫/插画
- 质量：高
- 数量：多张，选择最佳
```

---

#### 来源 3: 免费图库（Unsplash、Pexels）

**方法**:
- 搜索关键词
- 筛选符合场景的图片
- 下载并重命名

**优点**:
- ✅ 免费使用
- ✅ 高质量
- ✅ 无需注明

**缺点**:
- ❌ 不完全符合场景
- ❌ 风格不一

**搜索关键词**:
- "time travel", "laboratory", "science fiction"
- "mysterious", "suspense", "drama"

---

#### 来源 4: 用户提供的图片

**处理**:
- 接收用户提供的图片
- 调整尺寸（如需要）
- 重命名保存到图片文件夹
- 插入到章节文档

**来源**:
- 用户拍摄
- 用户绘制
- 用户收集

---

### Step 6: 插入图片到章节文档

**插入格式**:
```markdown
## 章节标题

### 开场

[正文...]

---

### 章节插画 1
![插画描述](/绝对路径/projects/web/novel-writing/images/[小说名]/chapter-3-插画-1.jpg)

### 场景图 1
![场景描述](/绝对路径/projects/web/novel-writing/images/[小说名]/chapter-3-场景-1.jpg)

### 场景图 2
![场景描述](/绝对路径/projects/web/novel-writing/images/[小说名]/chapter-3-场景-2.jpg)

---

## 结尾

[正文...]
```

**注意事项**:
- [ ] 使用绝对路径（确保图片显示）
- [ ] 图片尺寸合理（过大影响加载）
- [ ] 格式统一（推荐 JPG）
- [ ] 添加 Alt 文本（图片描述）

---

### Step 7: 验证图片显示

**验证方法**:
1. 在 Markdown 阅读器中打开章节文档
2. 检查图片是否正确显示
3. 检查图片路径是否正确
4. 如有问题，调整路径或格式

---

## 特殊情况处理

### 情况 1: 用户不需要配图

**处理**:
- 说明配图是可选功能
- 不强制添加
- 章节可以直接发布

### 情况 2: AI 生成 API 不可用

**处理**:
- 使用免费图库替代
- 或建议用户自行提供图片
- 继续其他流程

### 情况 3: 用户要求修改配图

**处理**:
1. 删除或重命名旧图片
2. 生成新图片
3. 更新章节文档中的图片引用
4. 验证新图片显示

---

## 质量检查清单

完成配图后，自检：

- [ ] 配图类型符合章节内容？
- [ ] 图片数量合理（3-8 张）？
- [ ] 图片来源符合优先级？
- [ ] 图片尺寸合适？
- [ ] 使用绝对路径？
- [ ] 图片格式统一（JPG/PNG）？
- [ ] 添加 Alt 文本？
- [ ] 图片正确显示？

---

## 常见错误避免

❌ **不要这样做**:
- 图片过多（超过 10 张/章）
- 图片过大（超过 2MB）
- 使用相对路径（可能不显示）
- 不添加 Alt 文本（无障碍问题）
- 盗用他人图片（未授权）
- 图片和章节内容不符

✅ **应该这样做**:
- 图片数量合理（3-8 张）
- 图片尺寸适中（< 1MB）
- 使用绝对路径
- 添加 Alt 文本
- 尊重版权
- 图片和章节内容相符

---

## Think Aloud 要求

**执行本 Skill 时，必须透明化思考**：

```
示例：

用户要求为第3章配图...

我思考：
- 需要分析第3章的内容
- 确定需要什么类型的图片
- 推荐配图数量和类型

我的计划：
1. 读取第3章内容
2. 分析配图需求：
   - 封面？可选
   - 插画：2-3 张（关键场景）
   - 场景图：3-5 张（开场/高潮/结尾）
3. 生成配图建议
4. 等待用户确认来源
5. 创建图片文件夹
6. 根据来源获取图片
7. 插入到章节文档
8. 验证图片显示

正在分析章节内容...
```

---

## 输入输出总结

**输入**:
- 章节文件（`drafts/` 或 `published/`）
- 用户可能的配图要求（类型、数量、来源）

**输出**:
- 配图建议文档
- 图片文件夹（`images/小说名/`）
- 更新的章节文档（插入图片）

**下一步**:
- 章节可直接发布或继续下一章

---

## 文件命名规范

**图片文件夹**: `images/[小说名]/`

**图片命名**:
- 封面：`cover.jpg`
- 插画：`chapter-[章节号]-插画-[序号].jpg`
- 场景图：`chapter-[章节号]-场景-[序号].jpg`

**示例**:
- `chapter-3-插画-1.jpg`
- `chapter-3-场景-1.jpg`

**路径**: `projects/web/novel-writing/images/[小说名]/`

---

## 图片插入示例

```markdown
# 第 3 章：穿越者现身

## 开场

林凡推开实验室的门，一股冷气扑面而来...

---

## 场景插画 1

![林凡在实验室门口](/data/data/com.termux/files/home/projects/web/novel-writing/images/时间旅行者/chapter-3-场景-1.jpg)

林凡停下了脚步。前面的桌子上，放着一个奇怪的银色装置...

## 高潮

那个神秘人突然开口了...

---

## 场景插画 2

![时间机器启动](/data/data/com.termux/files/home/projects/web/novel-writing/images/时间旅行者/chapter-3-场景-2.jpg)

光从装置中爆发出来...

---

## 结尾

林凡看着那个神秘人，心中充满了疑问...
```

---

## 与其他 Skills 的关系

- **Skill 7/8** → **Skill 9**: 写作/审校完成后，添加配图
- **Skill 9** → **发布**: 配图完成后，章节可发布到 `published/`

---

**最后更新**: 2024-12-26
**版本**: 第三阶段
